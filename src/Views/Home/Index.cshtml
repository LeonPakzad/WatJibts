@model IndexModel
@using Microsoft.AspNetCore.Identity

@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager

<h1>Wilkommen zu WatJibts!</h1>

<hr>
@if (!SignInManager.IsSignedIn(User))
{
    <p>
        Hier können Sie zusammen mit Freunden oder ihrem Team unterschiedliche arten von Essen organisieren.
    </p>

    <h2>Es scheint so als wären sie noch nicht angemeldet.</h2>
}
else
{
    @if(Model.activeLunchSessions.Count() > 0) 
    {
        @foreach(var lunchSession in Model.activeLunchSessions)
        {
            <div class="table-item">
                @lunchSession.lunchTime.ToString("hh:mm")
                @lunchSession.fk_foodPlace
                @lunchSession.fk_eatingPlace
                @Html.ActionLink("Anschließen", "QuickAdd", new {id = lunchSession.Id})
            </div>
        }
    }

    @if (Model.passiveLunchSessions.Count() > 0)
    {
        <h2>Folgende Menschen essen heute nicht oder privat:</h2>
        @foreach(var lunchSession in Model.activeLunchSessions)
        {
            <div class="table-item">
                @lunchSession.fk_user
            </div>
        }
    }
    
    @if(Model.activeLunchSessions.Count() < 1 && Model.passiveLunchSessions.Count() < 1)
    {
        <p>Heute wurde noch keine Session hinzugefügt</p>
    }

    <hr>
    <div class="user-input-container">

        @using (Html.BeginForm())
        {
            @Html.AntiForgeryToken()
        
            <div class="time-container">
                <div class="form-field">
                    <label class="form-label">LunchTime</label>
                    <input type="datetime" id="lunchTime" name="lunchTime" min="00:01" max="23:59" value="13:37"/>
                </div>
            </div>

            <div class="form-field">
                <label class="form-label">Participating</label>
                @Html.CheckBox("participating", false)
            </div>

            <div class="form-wrapper">
                <label class="form-label">Place to Eat</label>
                <select class="form-select" name="fk_eatingPlace" asp-for="LunchSession.fk_eatingPlace" asp-items="@(new SelectList(ViewBag.LocationsToEat, "Id", "name"))">
                    <option value="-1">kein Ort</option>
                </select>

                <label class="form-label">Place for Food</label>
                <select class="form-select" name="fk_foodPlace" asp-for="LunchSession.fk_foodPlace" asp-items="@(new SelectList(ViewBag.LocationsToGetFood, "Id", "name"))">
                        <option value="-1">keine Angabe</option>
                </select>
            </div>

            <button type="submit" class="">Submit</button>
        }
    </div>
}